(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{1498:function(e,a,t){Promise.resolve().then(t.bind(t,8999))},8999:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return x}});var r=t(7437),l=t(2265),s=t(7996),i=t(4230),n=t(5978);let d=async(e,a)=>{try{if(null!==a){let t=await c(e.kurumId);if(t.length>=a)throw Error("Kurum kontenjanı dolu (".concat(t.length,"/").concat(a,")"))}let t=(0,n.hJ)(i.db,"users"),r=(0,n.IO)(t,(0,n.ar)("email","==",e.email)),l=await (0,n.PL)(r);if(l.empty)throw Error("Kullanıcı bulunamadı");let s=l.docs[0],d=s.id;if((await c(e.kurumId)).some(e=>e.id===d))throw Error("Bu kullanıcı zaten kuruma kayıtlı");let m=(0,n.hJ)(i.db,"kurumUsers");return await (0,n.ET)(m,{userId:d,kurumId:e.kurumId,email:e.email,joinDate:new Date().toISOString().split("T")[0]}),await (0,n.pl)((0,n.JU)(i.db,"users",d),{...s.data(),kurumId:e.kurumId},{merge:!0}),d}catch(e){throw console.error("Error adding user to kurum: ",e),e}},c=async e=>{try{let a=(0,n.hJ)(i.db,"kurumUsers"),t=(0,n.IO)(a,(0,n.ar)("kurumId","==",e)),r=(await (0,n.PL)(t)).docs.map(e=>e.data().userId);if(0===r.length)return[];let l=r.map(async e=>{let a=await (0,n.QT)((0,n.JU)(i.db,"users",e));return{id:e,...a.data()}});return await Promise.all(l)}catch(e){throw console.error("Error fetching kurum users: ",e),e}},m=async(e,a)=>{try{let t=(0,n.hJ)(i.db,"kurumUsers"),r=(0,n.IO)(t,(0,n.ar)("userId","==",e),(0,n.ar)("kurumId","==",a)),l=await (0,n.PL)(r);if(l.empty)throw Error("Kurum-kullanıcı ilişkisi bulunamadı");let s=l.docs.map(e=>(0,n.oe)(e.ref));return await Promise.all(s),await (0,n.pl)((0,n.JU)(i.db,"users",e),{kurumId:null},{merge:!0}),!0}catch(e){throw console.error("Error removing user from kurum: ",e),e}};var o=t(974),u=t(9064),x=()=>{let[e,a]=(0,l.useState)(!1),[t,i]=(0,l.useState)([]),{user:n,kurumKontejan:x,isStudent:h,kurum:g,kurumId:f}=(0,o.Z)(),[p,y]=(0,l.useState)(!0),[b,w]=(0,l.useState)({email:"",ogrenciMi:!0,studentCode:"",teacherCode:""}),[v,j]=(0,l.useState)(""),[k,N]=(0,l.useState)(1),I=async e=>{if(!f){u.Am.error("Kurum bilgisi bulunamadı");return}if(window.confirm("Bu kullanıcıyı kurumdan \xe7ıkarmak istediğinize emin misiniz?"))try{await m(e,f);let a=await c(f);i(a),u.Am.success("Kullanıcı kurumdan başarıyla \xe7ıkarıldı")}catch(e){console.error("Error removing user: ",e),u.Am.error("Kullanıcı \xe7ıkarılırken hata oluştu: "+e.message)}};(0,l.useEffect)(()=>{a(!0),(async()=>{try{if(f){let e=await c(f);i(e)}else u.Am.error("Kurum bilgisi bulunamadı")}catch(e){console.error("Error fetching users: ",e),u.Am.error("Kullanıcılar y\xfcklenirken hata oluştu")}finally{y(!1)}})()},[f]);let z=async()=>{if(!b.email||!f){u.Am.error("Email alanı boş bırakılamaz");return}try{if(null!==x&&t.length>=x){u.Am.error("Kurum kontenjanı dolu (".concat(t.length,"/").concat(x,"). Daha fazla kullanıcı ekleyemezsiniz."));return}await d({email:b.email,kurumId:f},x);let e=await c(f);i(e),w({email:"",ogrenciMi:!0,studentCode:"",teacherCode:""}),u.Am.success("Kullanıcı başarıyla eklendi")}catch(e){console.error("Error adding user: ",e),u.Am.error("Kullanıcı eklenirken hata oluştu: "+e.message)}},C=t.filter(e=>{var a,t,r;return(null===(a=e.isim)||void 0===a?void 0:a.toLowerCase().includes(v.toLowerCase()))||e.email.toLowerCase().includes(v.toLowerCase())||e.ogrenciMi&&(null===(t=e.studentCode)||void 0===t?void 0:t.toLowerCase().includes(v.toLowerCase()))||!e.ogrenciMi&&(null===(r=e.teacherCode)||void 0===r?void 0:r.toLowerCase().includes(v.toLowerCase()))}),K=5*k,S=K-5,E=C.slice(S,K),L=Math.ceil(C.length/5);return!e||p?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-amber-600 text-lg",children:"Y\xfckleniyor..."})}):(0,r.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[n&&(0,r.jsx)("div",{className:"bg-white shadow rounded-lg p-6 mb-8",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4 mb-4 md:mb-0",children:[(0,r.jsx)("div",{className:"flex-shrink-0 h-12 w-12 rounded-full bg-amber-100 flex items-center justify-center",children:(0,r.jsx)(s.fzv,{className:"h-6 w-6 text-amber-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:n.email}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:h?"\xd6ğrenci":"\xd6ğretmen"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(s.m6D,{className:"h-5 w-5 text-gray-400"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Kurum"}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:g||"Bilinmiyor"})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(s.WY8,{className:"h-5 w-5 text-gray-400"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Kurum \xdcye Kontenjanı"}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:null!==x?(0,r.jsxs)("span",{children:[t.length,"/",x," (Kalan: ",x-t.length,")"]}):"Sınırsız"}),null!==x&&(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5 mt-1",children:(0,r.jsx)("div",{className:"bg-amber-600 h-1.5 rounded-full",style:{width:"".concat(Math.min(100,t.length/x*100),"%")}})})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(s.yK7,{className:"h-5 w-5 text-gray-400"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Durum"}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:h?"\xd6ğrenci":"\xd6ğretmen"})]})]})]})]})}),(0,r.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Kurum Y\xf6netimi"}),(0,r.jsxs)("div",{className:"relative mt-4 md:mt-0 w-full md:w-auto",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)(s.jRj,{className:"h-5 w-5 text-gray-400"})}),(0,r.jsx)("input",{type:"text",placeholder:"Kullanıcı ara...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm",value:v,onChange:e=>j(e.target.value)})]})]}),(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg overflow-hidden mb-8",children:[(0,r.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Yeni Kullanıcı Ekle"}),(0,r.jsxs)("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Adresi"}),(0,r.jsx)("input",{type:"email",id:"email",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-amber-500 focus:border-amber-500 sm:text-sm",placeholder:"email@example.com",value:b.email,onChange:e=>w({...b,email:e.target.value})})]}),(0,r.jsx)("div",{className:"flex items-end space-x-4",children:(0,r.jsxs)("button",{type:"button",onClick:z,disabled:!b.email,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-amber-600 hover:bg-amber-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,r.jsx)(s.OvN,{className:"mr-2 h-4 w-4"}),"Kullanıcı Ekle"]})})]})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kullanıcı"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"T\xfcr"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kod"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Katılım Tarihi"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"İşlemler"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:E.length>0?E.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-amber-100 flex items-center justify-center",children:(0,r.jsx)(s.fzv,{className:"h-5 w-5 text-amber-600"})}),(0,r.jsx)("div",{className:"ml-4",children:(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.isim||"İsim belirtilmemiş"})})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(s.Imn,{className:"flex-shrink-0 mr-2 h-4 w-4 text-gray-400"}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:e.email})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(e.ogrenciMi?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"),children:e.ogrenciMi?"\xd6ğrenci":"\xd6ğretmen"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-500",children:e.ogrenciMi?e.studentCode:e.teacherCode})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-500",children:new Date(e.joinDate).toLocaleDateString("tr-TR")})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,r.jsx)("button",{className:"text-red-600 hover:text-red-900",onClick:()=>I(e.id),children:(0,r.jsx)(s.Ybf,{className:"h-5 w-5"})})})]},e.id)):(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:6,className:"px-6 py-4 text-center text-sm text-gray-500",children:v?"Aradığınız kriterlere uygun kullanıcı bulunamadı":"Hen\xfcz kullanıcı eklenmedi"})})})]})}),C.length>5&&(0,r.jsx)("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:(0,r.jsxs)("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[(0,r.jsx)("div",{children:(0,r.jsxs)("p",{className:"text-sm text-gray-700",children:["Toplam ",(0,r.jsx)("span",{className:"font-medium",children:C.length})," kullanıcıdan"," ",(0,r.jsxs)("span",{className:"font-medium",children:[S+1,"-",Math.min(K,C.length)]})," arası g\xf6steriliyor"]})}),(0,r.jsx)("div",{children:(0,r.jsxs)("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[(0,r.jsx)("button",{onClick:()=>N(e=>Math.max(e-1,1)),disabled:1===k,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,r.jsx)(s.YFh,{className:"h-5 w-5"})}),Array.from({length:L},(e,a)=>a+1).map(e=>(0,r.jsx)("button",{onClick:()=>N(e),className:"relative inline-flex items-center px-4 py-2 border text-sm font-medium ".concat(k===e?"z-10 bg-amber-50 border-amber-500 text-amber-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"),children:e},e)),(0,r.jsx)("button",{onClick:()=>N(e=>Math.min(e+1,L)),disabled:k===L,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,r.jsx)(s.Tfp,{className:"h-5 w-5"})})]})})]})})]})]})})}},974:function(e,a,t){"use strict";var r=t(3301),l=t(5978),s=t(2265),i=t(4230);let n={"auth/user-not-found":"Bu email adresiyle kayıtlı kullanıcı bulunamadı","auth/wrong-password":"Yanlış şifre, l\xfctfen tekrar deneyin","auth/too-many-requests":"\xc7ok fazla başarısız giriş denemesi. L\xfctfen bir s\xfcre sonra tekrar deneyin","auth/user-disabled":"Bu hesap devre dışı bırakılmış","auth/invalid-email":"Ge\xe7ersiz email formatı","auth/operation-not-allowed":"Email/şifre ile giriş izni verilmemiş","auth/network-request-failed":"İnternet bağlantınız yok, l\xfctfen bağlantınızı kontrol edip tekrar deneyiniz","auth/requires-recent-login":"Bu işlem i\xe7in son zamanlarda giriş yapmış olmanız gerekiyor","auth/email-not-verified":"L\xfctfen email adresinizi doğrulayın","auth/institution-not-found":"Kurum bilgisi bulunamadı. Giriş yapamazsınız. L\xfctfen kurum paketi anlaşması sağlamak i\xe7in iletişime ge\xe7iniz: yapayline@gmail.com"};a.Z=()=>{let[e,a]=(0,s.useState)(null),[t,d]=(0,s.useState)(!1),[c,m]=(0,s.useState)(null),[o,u]=(0,s.useState)(null),[x,h]=(0,s.useState)(null),[g,f]=(0,s.useState)(!1),[p,y]=(0,s.useState)(null),b=e=>{if("object"==typeof e&&null!==e&&"code"in e){let a=e.code;return n[a]||"Bir hata oluştu: ".concat(a)}return"Beklenmeyen bir hata oluştu"},w=async(e,t,s)=>{f(!0),y(null);try{var n,c,o,x,g,p;let f=(await (0,r.e5)(i.I,e.trim(),t)).user;if(f&&!f.emailVerified)throw await (0,r.w7)(i.I),{code:"auth/email-not-verified"};document.cookie="loggedIn=true; path=/; ".concat(s?"max-age=3600":"");let y=await (0,l.QT)((0,l.JU)(i.db,"users",f.uid));if(!y.exists()||!(null===(n=y.data())||void 0===n?void 0:n.kurum))throw await (0,r.w7)(i.I),{code:"auth/institution-not-found"};return m((null===(c=y.data())||void 0===c?void 0:c.kurum)||null),u((null===(o=y.data())||void 0===o?void 0:o.kurumId)||null),h(null!==(p=null===(x=y.data())||void 0===x?void 0:x.kurumKontejan)&&void 0!==p?p:null),d((null===(g=y.data())||void 0===g?void 0:g.isStudent)||!1),s?localStorage.setItem("saved_email",e):localStorage.removeItem("saved_email"),a(f),f}catch(e){return y(b(e)),null}finally{f(!1)}},v=async e=>{try{f(!0);let g=await (0,l.QT)((0,l.JU)(i.db,"users",e));if(g.exists()){var a,t,r,s,n,c,o,x;d(null!==(n=null===(a=g.data())||void 0===a?void 0:a.isStudent)&&void 0!==n&&n),m(null!==(c=null===(t=g.data())||void 0===t?void 0:t.kurum)&&void 0!==c?c:null),u(null!==(o=null===(r=g.data())||void 0===r?void 0:r.kurumId)&&void 0!==o?o:null),h(null!==(x=null===(s=g.data())||void 0===s?void 0:s.kurumKontejan)&&void 0!==x?x:null)}else d(!1),m(null),u(null),h(null)}catch(e){y("Kullanıcı bilgileri alınırken hata oluştu")}finally{f(!1)}},j=async()=>{f(!0);try{await (0,r.w7)(i.I),a(null),d(!1),m(null),u(null),document.cookie="loggedIn=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",localStorage.removeItem("saved_email")}catch(e){y(b(e))}finally{f(!1)}},k=async e=>{f(!0);try{await (0,r.LS)(i.I,e.trim())}catch(e){y(b(e))}finally{f(!1)}},N=async(a,t)=>{f(!0);try{if(!e||!e.email)throw{code:"auth/no-current-user"};let l=r.w9.credential(e.email,t);await (0,r.aF)(e,l),await (0,r.gQ)(e,a)}catch(e){y(b(e))}finally{f(!1)}};return(0,s.useEffect)(()=>{let e=(0,r.Aj)(i.I,async e=>{e?(await v(e.uid),a(e)):(a(null),d(!1),m(null),u(null))});return()=>e()},[]),{user:e,isStudent:t,kurum:c,kurumId:o,kurumKontejan:x,isLoading:g,errorMessage:p,login:w,signOut:j,resetPassword:k,changePassword:N}}},4230:function(e,a,t){"use strict";let r;t.d(a,{I:function(){return n},db:function(){return d}});var l=t(738),s=t(5978),i=t(3301);let n={},d={};try{r=0===(0,l.C6)().length?(0,l.ZF)({apiKey:"dummy-api-key-for-static-build",authDomain:"dummy-domain.firebaseapp.com",projectId:"dummy-project",storageBucket:"dummy-bucket.appspot.com",messagingSenderId:"123456789",appId:"1:123456789:web:abc123",measurementId:"G-ABC123"}):(0,l.C6)()[0],n=(0,i.v0)(r),d=(0,s.ad)(r)}catch(e){console.error("Firebase initialization error:",e)}}},function(e){e.O(0,[358,242,956,943,67,971,117,744],function(){return e(e.s=1498)}),_N_E=e.O()}]);